# 調査結果

## YouTube Data API v3調査

### 概要
YouTube Data APIは、YouTubeプラットフォーム上のデータにプログラムからアクセスするためのAPIです。チャンネル情報、動画メタデータ、視聴統計などを取得できます。

### API制限
- **クォータ制限**: 1日あたり10,000ユニットの基本クォータ
- **主要操作のコスト**:
  - 検索: 100ユニット
  - 動画一覧取得: 1ユニット
  - 動画詳細取得: 1ユニット
  - コメント取得: 1ユニット

### 認証方式
- **APIキー認証**: 基本的なデータ取得（パブリックデータのみ）
- **OAuth 2.0認証**: ユーザーデータへのアクセスや操作が必要な場合

### エンドポイント調査

#### チャンネル情報取得
```
GET https://www.googleapis.com/youtube/v3/channels
```
- **主要パラメータ**:
  - `part`: `snippet`, `statistics`, `contentDetails`, `brandingSettings`など
  - `id`: チャンネルIDによる指定
  - `mine`: true（認証済みユーザー自身のチャンネル）
- **取得可能なデータ**:
  - チャンネル名、説明、サムネイル
  - 登録者数、総再生回数
  - アップロードプレイリストID
  - チャンネルバナー、アイコン

#### 動画一覧取得
```
GET https://www.googleapis.com/youtube/v3/search
```
- **主要パラメータ**:
  - `part`: `snippet`
  - `channelId`: 特定チャンネルの動画を取得
  - `type`: `video`
  - `order`: `date`, `viewCount`, `rating`など
  - `maxResults`: 1回のリクエストで取得する最大件数
- **取得可能なデータ**:
  - 動画ID、タイトル、説明
  - サムネイル
  - 公開日時

#### 動画詳細取得
```
GET https://www.googleapis.com/youtube/v3/videos
```
- **主要パラメータ**:
  - `part`: `snippet`, `statistics`, `contentDetails`など
  - `id`: 動画ID（複数指定可能）
- **取得可能なデータ**:
  - タイトル、説明
  - 再生回数、高評価数、コメント数
  - 動画時間
  - タグ
  - カテゴリID

#### 動画統計情報取得
```
GET https://www.googleapis.com/youtube/v3/videos
```
- **主要パラメータ**:
  - `part`: `statistics`
  - `id`: 動画ID
- **取得可能なデータ**:
  - 再生回数
  - 高評価数
  - コメント数
  - お気に入り追加数

### 制約と課題
1. **高度な分析データへのアクセス制限**:
   - YouTube Analyticsの詳細データはChannel DashboardからのみアクセスでYouTube Data APIでは取得不可
   - 視聴者層、視聴維持率などの詳細分析は直接取得できない

2. **更新頻度**:
   - 統計データの更新は即時ではなく、24-48時間の遅延がある場合がある

3. **クォータ管理の必要性**:
   - 多数のチャンネルや動画を扱う場合、クォータ上限に達する可能性あり
   - 効率的なキャッシング戦略が必要

4. **OAuth認証の複雑さ**:
   - ユーザーチャンネルへのアクセスには複雑なOAuth認証フローが必要
   - リフレッシュトークンの管理が必要

### 対応策
1. **効率的なデータ取得戦略**:
   - 必要最小限の`part`パラメータ指定
   - バッチ処理での複数アイテム同時取得
   - サーバーサイドキャッシングの実装

2. **データ更新戦略**:
   - 重要なデータの定期的な更新スケジュール設定
   - ユーザー操作による即時更新とバックグラウンド更新の併用

3. **OAuth認証フロー改善**:
   - セッション管理との統合
   - リフレッシュトークンの安全な保存
   - 明確な権限スコープの設定

4. **エラーハンドリング**:
   - レート制限エラーの適切な処理
   - 一時的なサービス停止時の再試行ロジック

## PDF/Excelレポート生成調査

### PDF生成（jspdf & jspdf-autotable）

#### 主要機能
- テキスト、画像、グラフの描画
- 自動テーブル生成（jspdf-autotable）
- ヘッダー・フッター設定
- ページ番号自動生成

#### 実装上の注意点
- 日本語フォント対応には特別な設定が必要
- 大量データの処理はメモリ使用量に注意
- スタイリングはCSS相当の柔軟性がない

#### 推奨実装方法
- コンポーネント化したPDF生成サービス
- 非同期処理による大量データ対応
- サーバーサイドでの生成オプション検討

### Excel生成（xlsx）

#### 主要機能
- 複数ワークシート対応
- セルのスタイリング
- 数式の埋め込み
- グラフ作成

#### 実装上の注意点
- ブラウザメモリ制限を考慮したチャンク処理
- 複雑なスタイリングはパフォーマンスに影響
- バイナリデータのダウンロード処理に注意

#### 推奨実装方法
- テンプレートベースの生成
- ワーカースレッドでの処理検討
- 大量データの場合はサーバーサイド生成 